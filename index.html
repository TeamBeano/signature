<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src='bower_components/jquery/dist/jquery.js'></script>
    <script type="text/javascript" src='bower_components/mustache.js/mustache.js'></script>
    <script type="text/javascript">
      $(document).ready(function() {
        updatePreview()
      })
      $(document).on('change input', '.fields input', function() {
        updatePreview()
      })

      function updatePreview() {
        html = renderTemplate('#html_content', loadFormData())
        html = html.trim().replace(/\s{2,}/g, ' ').replace(/>\s+?</, "><")
        $('.output').text(html)
        $('.preview').html(html)
      }

      function loadFormData() {
        return {
          name: $('input.name').val(),
          role: $('input.role').val(),
          landline: $('input.landline').val(),
          mobile: $('input.mobile').val(),
          email: $('input.email').val(),
          address1: $('input.address1').val(),
          address2: $('input.address2').val(),
          address3: $('input.address3').val(),
          address4: $('input.address4').val(),
        }
      }

      function renderTemplate(template, data) {
        var template = $(template).html();
        Mustache.parse(template);
        var rendered = Mustache.render(template, data);
        return rendered
      }

    </script>
  </head>
  <body>
    <form class="fields" action="#" method="get">
      <p>Name: <input type="text" class='name' value="Michelle Milner-Eradhun"></p>
      <p>Role: <input type="text" class='role' value="EA to Emma Scott and Beano Studios"></p>
      <p>Landline: <input type="text" class='landline' value="+44 (0) 207 400 1091"></p>
      <p>Mobile: <input type="text" class='mobile' value="+44 (0) 777 1234 567"></p>
      <p>Email: <input type="text" class='email' value="michelle.milner@beano.com"></p>
      <p>Address 1: <input type="text" class='address1' value="Beano Studios"></p>
      <p>Address 2: <input type="text" class='address2' value="185 Fleet Street"></p>
      <p>Address 3: <input type="text" class='address3' value="London"></p>
      <p>Address 4: <input type="text" class='address4' value="EC4A 2HS"></p>
    </form>
    <hr>
    <div class="preview"></div>
    <p></p>
    <hr>
    <textarea name="name" class='output' rows="40" cols="100"></textarea>
  </body>
</html>

<script id="html_content" type="x-tmpl-mustache">
<table border="0" cellpadding="0" cellspacing="0" style="border-bottom-color: #d9d9d9; border-bottom-style: solid; border-bottom-width: 1px; max-width: 800px; min-width: 300px; width: 100%">
  <tr>
    <td style="color: #6a6a6a; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 13px; text-align: left; vertical-align: top" align="left" valign="top">

      <table align="left" width="600" border="0" cellpadding="0" cellspacing="0" style="width: 100%">
        <tr>
          <td style="color: #6a6a6a; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 13px; text-align: left; vertical-align: top" align="left" valign="top">
            <table align="left" width="180" cellpadding="0" cellspacing="0" border="0" style="width: 100%">
                <tbody>
                    <tr>
                        <td style="color: #6a6a6a; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 13px; text-align: left; vertical-align: top" align="left" valign="top">
                          <span style="color: #000; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 18px; font-weight: bold; text-align: left; vertical-align: top" align="left" valign="top">
                            {{name}}
                          </span><br>
                          <span style="color: #d84323; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 14px; text-align: left; vertical-align: top" align="left" valign="top">
                            {{role}}
                          </span><br><br>
                          {{landline}}<br>
                          {{mobile}}<br>
                          <a href="mailto:%7B%7Bemail%7D%7D" target="_blank" style="color: #6a6a6a; text-decoration: none">{{email}}</a><br>
                          <a href="http://beano.com" style="color: #6a6a6a; text-decoration: none">beano.com</a><br><br>

                          <table width="60" style="width: 100%">
                            <tr>
                              <td align="left" valign="top">
                                <a href="https://www.facebook.com/TheBeanoComic/" style="display: block; float: left; text-decoration: none"><img src="http://teambeano.github.io/signature/facebook.jpg" style="-ms-interpolation-mode: bicubic; border: none; display: block; height: auto; max-width: 100%; outline: none; text-decoration: none"></a>
                                <a href="https://twitter.com/BeanoComic" style="display: block; float: left; text-decoration: none"><img src="http://teambeano.github.io/signature/twitter.jpg" style="-ms-interpolation-mode: bicubic; border: none; display: block; height: auto; max-width: 100%; outline: none; text-decoration: none"></a>
                                <a href="https://www.instagram.com/thebeanocomic/" style="display: block; float: left; text-decoration: none"><img src="http://teambeano.github.io/signature/instagram.jpg" style="-ms-interpolation-mode: bicubic; border: none; display: block; height: auto; max-width: 100%; outline: none; text-decoration: none"></a>
                              </td>
                            </tr>
                          </table>
                        </td>
                        <td style="margin-top:-20px;width: 178px" align="left" valign="top">
                          <img src="http://teambeano.github.io/signature/wham.gif">
                        </td>
                    </tr>
                </tbody>
            </table>

            <table align="left" width="180" style="border-bottom-color: #d9d9d9; border-bottom-width: 1px; border-style: solid none; border-top-color: #d9d9d9; border-top-width: 1px; display: block; margin: 0 0 10px; width: 100%">
              <tr>
                <td style="color: #6a6a6a; font-family: Trebuchet MS1, Trebuchet MS, sans-serif; font-size: 13px; padding: 15px 0; text-align: left;" align="left" valign="top">
                  {{address1}},
                  {{address2}},
                  {{address3}},
                  {{address4}}
                </td>
              </tr>
            </table>
            <table align="left" width="150" style="width: 100%">
              <tr>
              <td width="150" align="left" valign="top">
                <a href="http://beano.com" style="text-decoration: none"><img src="http://teambeano.github.io/signature/beano-logo.gif" style="-ms-interpolation-mode: bicubic; border: none; display: block; height: auto; margin: 15px 0; max-width: 100%; outline: none; text-decoration: none"></a>
              </td>
          </tr>
        </table>
        </td>
</tr>
      </table>
    </td>
  </tr>
</table>
</script>
